[
  {
    "cove": "https://cdn.manyacg.top/regular/pixiv/2062642/6796a212d85bd993506e89dd_regular.webp",
    "name": "艾利浩斯",
    "link": [
      "https://alhs.xyz/"
    ],
    "meta": [
      "小说"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/regular/pixiv/2062642/6796a212d85bd993506e89dd_regular.webp',\n  name: '艾利浩斯',\n  link: ['https://alhs.xyz/'],\n  meta: ['小说']\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  list: {\n    url: 'index.php/page/{{page}}',\n    path: ['page'],\n  },\n  tag: {\n    url: 'index.php/archives/tag/{{tag}}/page/{{page}}',\n    path: ['tag', 'page'],\n  },\n  search: {\n    url: 'index.php/page/{{page}}',\n    path: ['page'],\n    query: ['s'],\n    defaults: {}\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => [\n  { mode: 'radio', name: '最新', code: '@route=list' },\n  { mode: 'radio', name: 'SM', code: '@route=tag tag=sm' },\n  { mode: 'radio', name: '调教', code: '@route=tag tag=tiao-jiao' },\n  { mode: 'radio', name: '口交', code: '@route=tag tag=kou-jiao' },\n  { mode: 'radio', name: '女仆', code: '@route=tag tag=nv-pu' },\n  { mode: 'radio', name: '人妻', code: '@route=tag tag=ren-qi' },\n]\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n\n  // Gemini: 搜索时参数映射\n  if (params.query) {\n    params.s = params.query\n    config.route = 'search'\n  }\n\n  const { url } = build(info.link[0], routes, config, params)\n  const document = await fetchHTML(url)\n\n  return [...document.querySelectorAll('article')].map(el => {\n    const href = el.querySelector('a.post-title')?.getAttribute('href')\n    return {\n      link: href,\n      mode: 'novel',\n      name_more: [el.querySelector('.post-meta-detail-author a')?.textContent],\n      name: [el.querySelector('.post-title')?.textContent],\n      cove: ['https://alhs.xyz/wp-content/uploads/2021/05/cropped-1620478139-wei-biao-ti-1.png'],\n      word: [\n        el.querySelector('.post-meta-detail-catagory-link')?.textContent,\n        ...[...el.querySelectorAll('.post-tags a')].map(el => el.textContent)\n      ].filter(Boolean),\n      card: `function:card(\"${href}\")`\n    }\n  })\n}\n\n// ==================== 详情解析 ====================\nconst card = async (link = '') => {\n  const document = await fetchHTML(link)\n  return {\n    card: [{\n      novel: document.querySelector('#post_content')?.textContent\n        ?.split('\\n')\n        .map(v => v.trim())\n        .filter(Boolean)\n        .join('\\n')\n    }]\n  }\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/twitter/1569682741960278016/78fba201fdb837a43421a65b495fd75f_regular.webp",
    "name": "ANIONE",
    "link": [
      "https://anime1.me/"
    ],
    "meta": [
      "动漫"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/twitter/1569682741960278016/78fba201fdb837a43421a65b495fd75f_regular.webp',\n  name: 'ANIONE',\n  link: ['https://anime1.me/'],\n  meta: ['动漫']\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  list: {\n    url: 'https://anime1.me/animelist.json',\n    method: 'GET',\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => [\n  { mode: 'radio', name: '最新', code: '@route=list' },\n]\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n  const page = Number(params.page) || 1\n  const pageSize = 20\n\n  // Gemini: 使用统一的 build() 构建 URL\n  if (!config.route) config.route = 'list'\n  const { url } = build(info.link[0], routes, config, params)\n  let json = await fetchJSON(url)\n\n  // Gemini: 支持搜索过滤\n  if (params.query) {\n    const query = params.query.toLowerCase()\n    json = json.filter(([id, name]) => name.toLowerCase().includes(query))\n  }\n\n  return json\n    .slice((page - 1) * pageSize, page * pageSize)\n    .map(([id, name]) => ({\n      mode: 'video',\n      link: `https://anime1.me/?cat=${id}`,\n      cove: ['https://sta.anicdn.com/playerImg/8.jpg'],\n      name: [name],\n      card: `function:card(\"https://anime1.me/?cat=${id}\")`\n    }))\n}\n\n// ==================== 详情解析 ====================\nconst card = async (link = '') => {\n  const document = await fetchHTML(link)\n  const articles = [...document.querySelectorAll('article.post')]\n\n  return Promise.all(articles.map(async (v, k) => {\n    const videoEl = document.querySelector('video')\n    if (!videoEl) return null\n\n    const apiReq = decodeURIComponent(videoEl.getAttribute('data-apireq'))\n    const res = await fetch('https://v.anime1.me/api', {\n      method: 'POST',\n      headers: { 'content-type': 'application/x-www-form-urlencoded' },\n      body: new URLSearchParams({ d: apiReq }).toString(),\n    })\n\n    const data = await res.json()\n    return {\n      name: `No.${k + 1}`,\n      video: `https:${data.s[0].src}`,\n      headers: {\n        cookie: res.headers.getSetCookie().map(v => v.split(';')[0]).join(';')\n      },\n    }\n  })).then(v => v.filter(Boolean))\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/pixiv/14094820/494691d9b3016a643d68725bdb3c4f83_regular.webp",
    "name": "ASMR1",
    "link": [
      "https://api.asmr-200.com/"
    ],
    "meta": [
      "ASMR"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/pixiv/14094820/494691d9b3016a643d68725bdb3c4f83_regular.webp',\n  name: 'ASMR1',\n  link: ['https://api.asmr-200.com/'],\n  meta: ['ASMR']\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  popular: {\n    url: 'api/recommender/popular',\n    method: 'POST',\n  },\n  list: {\n    url: 'api/works',\n    method: 'GET',\n    query: ['order', 'sort', 'page', 'pageSize', 'subtitle', 'tags'],\n    defaults: { pageSize: 20 }\n  },\n  search: {\n    url: 'api/search/{{query}}',\n    method: 'GET',\n    path: ['query'],\n    query: ['order', 'sort', 'page', 'pageSize', 'subtitle', 'includeTranslationWorks', 'tags'],\n    defaults: { pageSize: 20, includeTranslationWorks: true }\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => {\n  // Gemini: 动态获取并解析标签列表\n  const tags = await fetch('https://api.asmr-200.com/api/tags/')\n    .then(r => r.json())\n    .catch(() => [])\n\n  const tagItems = tags\n    .sort((a, b) => b.count - a.count)\n    .map(t => ({\n      mode: 'choice',\n      name: t.i18n?.['zh-cn']?.name || t.name,\n      code: `tag=${t.name}`\n    }))\n\n  return [\n    { mode: 'radio', name: '最新', code: '@route=list' },\n    { mode: 'radio', name: '热门', code: '@route=popular' },\n\n    { mode: 'line', name: '排序' },\n    { mode: 'choice', name: '发售', code: 'order=release' },\n    { mode: 'choice', name: '收录', code: 'order=create_date' },\n    { mode: 'choice', name: '评分', code: 'order=rate_average_2dp' },\n    { mode: 'choice', name: '销量', code: 'order=dl_count' },\n    { mode: 'choice', name: '价格', code: 'order=price' },\n    { mode: 'choice', name: '评论', code: 'order=review_count' },\n    { mode: 'choice', name: 'RJ号', code: 'order=id' },\n    { mode: 'choice', name: 'R18', code: 'order=nsfw' },\n    { mode: 'choice', name: '随机', code: 'order=random' },\n\n    { mode: 'line', name: '方向' },\n    { mode: 'choice', name: '最新', code: 'sort=desc' },\n    { mode: 'choice', name: '最旧', code: 'sort=asc' },\n\n    { mode: 'line', name: '字幕' },\n    { mode: 'choice', name: '有字幕', code: 'subtitle=1' },\n    { mode: 'choice', name: '无字幕', code: 'subtitle=0' },\n\n    { mode: 'line', name: '标签' },\n    ...tagItems\n  ]\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n\n  // Gemini: 标签筛选转换为特定的搜索格式\n  if (params.tag) {\n    params.query = ` $tag:${params.tag}$`\n    config.route = 'search'\n  }\n\n  const { url, method } = build(info.link[0], routes, config, params)\n\n  return fetch(url, { method })\n    .then(r => r.json())\n    .then(v => v.works || v)\n    .then(v => v.map(item => ({\n      link: `https://api.asmr-200.com/api/tracks/${item.id}`,\n      mode: 'audio',\n      name_more: [item.name],\n      cove: [item.mainCoverUrl],\n      name: [item.title],\n      word: [\n        `RJ${`${item.id}`.padStart(8, '0')}`,\n        ...item.tags.map(t => `${t.name}@tag=${t.name}`)\n      ],\n      card: `function:card(\"https://api.asmr-200.com/api/tracks/${item.id}\")`\n    })))\n}\n\n// ==================== 详情解析 ====================\nconst card = async (link = 'https://api.asmr-200.com/api/tracks/01489429') => {\n  return fetch(link)\n    .then(r => r.json())\n    .then(n => {\n      const f = n => n.length ? n.flatMap(({ children = [], ...rest }) => [rest, ...f(children)]) : []\n      return f(n)\n    })\n    .then(n => n.filter(v => v.type == 'audio'))\n    .then(n => n.filter((v, i, a) => i == a.findIndex(t => t.title.replace(/\\.[^/.]+$/, \"\") == v.title.replace(/\\.[^/.]+$/, \"\"))))\n    .then(n => n.map(v => ({ name: v.title, video: v.mediaStreamUrl, track: n.find(s => s.title === v.title + '.vtt')?.mediaStreamUrl || undefined })))\n    .then(v => v.sort((a, b) => a.name < b.name ? -1 : 1))\n    .then(card => ({ card }))\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/bilibili/592236/8d2ace2da39d2155b164603ac48895d2_regular.webp",
    "name": "HANIME",
    "link": [
      "https://hanimeone.me/",
      "https://hanime1.me/"
    ],
    "meta": [
      "里番"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/bilibili/592236/8d2ace2da39d2155b164603ac48895d2_regular.webp',\n  name: 'HANIME',\n  link: ['https://hanimeone.me/', 'https://hanime1.me/'],\n  meta: ['里番']\n}\n\n// ==================== 路由配置 ====================\n// Gemini: 统一使用 build() 构建 URL\nconst routes = {\n  search: {\n    url: 'search',\n    query: ['query', 'genre', 'tags[]', 'page'],\n    defaults: { page: '1' }\n  }\n}\n\n// ==================== 工具函数 ====================\n\n// Gemini: 获取带 Cloudflare 验证的 headers\nconst getHeaders = async () => {\n  return onCall({ _: 'verifyChallenge', url: info.link[0] })\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => {\n  const headers = await getHeaders()\n  const document = await fetchHTML(`${info.link[0]}search`, { headers })\n  const result = []\n\n  // Gemini: 解析 genre 类型\n  const genreItems = [...document.querySelectorAll('.simple-dropdown-item.genre-option')]\n  const genres = new Set()\n\n  for (const item of genreItems) {\n    const value = item.getAttribute('data-value')\n    const name = item.querySelector('.hentai-sort-options')?.textContent?.trim() || value\n    if (value && !genres.has(value)) {\n      genres.add(value)\n      result.push({\n        mode: 'radio',\n        name,\n        code: `genre=${value.replace(/ /g, '+')}`\n      })\n    }\n  }\n\n  // Gemini: 解析 tags 标签（按 h5 分类）\n  const tagSections = [...document.querySelectorAll('h5')]\n  const tags = new Set()\n\n  for (const h5 of tagSections) {\n    const categoryName = h5.textContent?.trim()\n    if (!categoryName) continue\n\n    const labels = []\n    let sibling = h5.nextElementSibling\n    while (sibling && sibling.tagName !== 'H5') {\n      if (sibling.classList?.contains('hentai-tags-wrapper')) {\n        labels.push(sibling)\n      }\n      sibling = sibling.nextElementSibling\n    }\n\n    if (labels.length > 0) {\n      result.push({ mode: 'line', name: categoryName })\n\n      for (const label of labels) {\n        const input = label.querySelector('input[name=\"tags[]\"]')\n        const span = label.querySelector('.checkmark')\n        if (input && span) {\n          const value = input.getAttribute('value')\n          const name = span.textContent?.trim()\n          if (value && !tags.has(value)) {\n            tags.add(value)\n            result.push({\n              mode: 'choice',\n              name: name || value,\n              code: `tags[]=${value.replace(/ /g, '+')}`\n            })\n          }\n        }\n      }\n    }\n  }\n\n  return result\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1 genre=全部'\n  const { config, params } = parse(input)\n  const headers = await getHeaders()\n  if (!config.route) config.route = 'search'\n  const { url } = build(info.link[0], routes, config, params)\n  console.log(url)\n\n  const document = await fetchHTML(url, { headers })\n  const rows = [...document.querySelectorAll('.home-rows-videos-wrapper a')]\n    .filter(el => el.getAttribute('href')?.includes('watch'))\n    .map(el => ({\n      mode: 'video',\n      link: el.getAttribute('href'),\n      cove: [el.querySelector('img')?.getAttribute('src')],\n      name: [el.querySelector('.home-rows-videos-title')?.textContent],\n      card: `function:card(\"${el.getAttribute('href')}\")`\n    }))\n\n  const cols = [...document.querySelectorAll('.horizontal-row > .video-item-container')]\n    .map(el => ({\n      mode: 'video',\n      link: el.querySelector('a')?.getAttribute('href'),\n      name_more: [el.querySelector('.subtitle')?.textContent?.trim()?.split(' ')[0]],\n      cove: [el.querySelector('img')?.getAttribute('src')],\n      name: [el.querySelector('.title')?.textContent?.trim()],\n      card: `function:card(\"${el.querySelector('a')?.getAttribute('href')}\")`\n    }))\n\n  return [...rows, ...cols]\n}\n\n// ==================== 详情解析 ====================\nconst card = async (link = '') => {\n  const headers = await getHeaders()\n  const document = await fetchHTML(link, { headers })\n  const sources = [...document.querySelectorAll('video#player source')]\n  const videoSrc = sources.find(s => s.getAttribute('size') === '1080')?.getAttribute('src')\n    ?? sources.sort((a, b) => Number(b.getAttribute('size') ?? 0) - Number(a.getAttribute('size') ?? 0))[0]?.getAttribute('src')\n  return {\n    cove_more: [document.querySelector('#video-user-avatar + img')?.getAttribute('src')],\n    name_more: [document.querySelector('#video-artist-name')?.textContent?.trim()],\n    cove: document.querySelector('video')?.getAttribute('poster'),\n    note: [document.querySelector('.video-caption-text')?.textContent?.trim()],\n    word: [...document.querySelectorAll('.single-video-tag a[href*=\"search\"]')]\n      .map(el => el.textContent?.split('(')[0].replace('#', '').trim())\n      .filter(Boolean),\n    card: [{ video: videoSrc }]\n  }\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/regular/twitter/yunoluria/666ead37dc890b0eb2186e56_regular.webp",
    "name": "IWARA",
    "link": [
      "https://api.iwara.tv/"
    ],
    "meta": [
      "MMD"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/regular/twitter/yunoluria/666ead37dc890b0eb2186e56_regular.webp',\n  name: 'IWARA',\n  link: ['https://api.iwara.tv/'],\n  meta: ['MMD'],\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  list: {\n    url: 'videos',\n    query: ['sort', 'page'],\n    defaults: { sort: 'date' }\n  },\n  search: {\n    url: 'search',\n    query: ['query', 'type', 'page'],\n    defaults: { type: 'videos' }\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => [\n  { mode: 'radio', name: '最新', code: 'sort=date' },\n  { mode: 'radio', name: '热门', code: 'sort=trending' },\n  { mode: 'radio', name: '榜单', code: 'sort=popularity' },\n  { mode: 'radio', name: '浏览', code: 'sort=views' },\n  { mode: 'radio', name: '点赞', code: 'sort=likes' },\n]\n\n// ==================== 详情解析 ====================\nconst getMeta = async (link = '') => {\n  const data = await fetchJSON(link)\n  const fileId = data.file?.id\n  const expires = new URL(data.fileUrl).searchParams.get('expires')\n  const hash = await sha(`${fileId}_${expires}_5nFp9kmbNnHdAFhaqMvt`, 'sha-1')\n  const sources = await fetchJSON(data.fileUrl, { headers: { 'x-version': hash } })\n  const source = sources.find(f => f?.name === 'Source')\n  return {\n    mode: 'video',\n    link: link.replace('api.', ''),\n    cove_more: [`https://i.iwara.tv/image/avatar/${data.user?.avatar?.id}/${data.user?.avatar?.name}`],\n    name_more: [data.user?.name],\n    cove: [`https://i.iwara.tv/image/thumbnail/${fileId}/thumbnail-${`${data.thumbnail}`.padStart(2, '0')}.jpg`],\n    name: [data.title],\n    note: [data.body],\n    word: data.tags.map(v => v?.id),\n    card: [{\n      cove: `https://i.iwara.tv/image/thumbnail/${fileId}/thumbnail-${`${data.thumbnail}`.padStart(2, '0')}.jpg`,\n      video: source ? `https:${source.src.view}` : null\n    }]\n  }\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n\n  // Gemini: iwara 页码从 0 开始\n  params.page = (Number(params.page) || 1) - 1\n\n  const { url } = build(info.link[0], routes, config, params)\n  const data = await fetchJSON(url)\n\n  // Gemini: 批量获取视频详情\n  const links = data.results.map(v => `https://api.iwara.tv/video/${v.id}`)\n  const results = await Promise.all(links.map(getMeta)).catch(() => [])\n\n  return results.filter(Boolean)\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/regular/twitter/1463480875891322885/68615e9b5e2096a6f166228e_regular.webp",
    "name": "GIRILOVE",
    "link": [
      "https://bgm.girigirilove.com/",
      "https://anime.girigirilove.top/",
      "https://love.girigirilove.com/"
    ],
    "meta": [
      "动漫"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/regular/twitter/1463480875891322885/68615e9b5e2096a6f166228e_regular.webp',\n  name: 'GIRILOVE',\n  link: ['https://bgm.girigirilove.com/', 'https://anime.girigirilove.top/', 'https://love.girigirilove.com/'],\n  meta: ['动漫']\n}\n\n// ==================== 路由配置 (template 模式) ====================\nconst routes = {\n  list: {\n    template: 'show/{{code}}-{{quarter}}-{{sort}}-{{type}}-{{lang}}----{{page}}-{{mode}}--{{year}}/',\n    keys: ['code', 'quarter', 'sort', 'type', 'lang', 'page', 'mode', 'year'],\n    defaults: { code: '', quarter: '', sort: '', type: '', lang: '', page: 1, mode: '', year: '' }\n  },\n  search: {\n    template: 'search/{{query}}----------{{page}}---/',\n    keys: ['query', 'page'],\n    defaults: { query: '', page: 1 }\n  }\n}\n\n// ==================== 过滤器配置 ====================\nconst filters = [\n  {\n    key: 'code', mode: 'radio',\n    items: [\n      { name: '日番', val: '2' },\n      { name: '美番', val: '3' },\n      { name: '剧场版', val: '21' }\n    ]\n  },\n  {\n    name: '排序', key: 'sort', mode: 'choice',\n    items: [\n      { name: '更新', val: 'time' },\n      { name: '热门', val: 'hits' },\n      { name: '评分', val: 'score' }\n    ]\n  },\n  {\n    name: '类型', key: 'type', mode: 'choice',\n    items: [\n      '喜剧', '爱情', '恐怖', '动作', '科幻', '剧情', '战争', '奇幻', '冒险',\n      '悬疑', '校园', '后宫', '热血', '运动', '职场', '百合', '乙女', '机甲',\n      '日常', '魔法少女', '异世界', '废萌', '音乐', '萌'\n    ].map(v => ({ name: v, val: v }))\n  },\n  {\n    name: '季度', key: 'quarter', mode: 'choice',\n    items: ['一月', '四月', '七月', '十月'].map(v => ({ name: v, val: v }))\n  },\n  {\n    name: '年份', key: 'year', mode: 'choice',\n    items: Array.from({ length: 23 }, (_, i) => ({ name: `${2026 - i}`, val: `${2026 - i}` }))\n  },\n  {\n    name: '语言', key: 'lang', mode: 'choice',\n    items: [{ name: '日语', val: '日语' }, { name: '国语', val: '国语' }]\n  },\n  {\n    name: '资源', key: 'mode', mode: 'choice',\n    items: ['小说改', '漫画改', '游戏改', '原创'].map(v => ({ name: v, val: v }))\n  }\n]\n\n// ==================== 过滤器 ====================\nconst meta = async () => {\n  return filters.flatMap(group => [\n    group.name ? { mode: 'line', name: group.name } : null,\n    ...group.items.map(item => ({\n      mode: group.mode,\n      name: item.name,\n      code: `${group.key}=${item.val}`\n    }))\n  ]).filter(Boolean)\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n  const { url } = build(info.link[0], routes, config, params)\n  const { document } = await fetch(url, {\n    headers: { cookie: `PHPSESSID=8jfdges51vktm2vgsjfrkkekqa` }\n  }).then(r => r.text()).then(parseHTML)\n  return [\n    ...document.querySelectorAll('.public-list-box.public-pic-b'),\n    ...document.querySelectorAll('.search-list')\n  ].map(el => {\n    const linkEl = el.querySelector('a');\n    const fullLink = URL.parse(linkEl.getAttribute('href'), url).href\n    return {\n      mode: 'video',\n      link: fullLink,\n      cove: [`${URL.parse(el.querySelector('img')?.getAttribute('data-src'), url)}`],\n      name: [linkEl?.getAttribute('title') || linkEl?.textContent],\n      card: `function:card(\"${fullLink}\")`\n    }\n  })\n}\n\n// ==================== 详情解析 ====================\nconst card = async (url = '') => {\n  const document = await fetchHTML(url)\n  return {\n    card: [...document.querySelectorAll('.anthology-list-play a')].map(el => ({\n      name: el.textContent?.trim(),\n      video: `function:play(\"${URL.parse(el.getAttribute('href'), url).href}\")`\n    }))\n  }\n}\n\n// ==================== 播放解析 ====================\nconst play = async (url = '') => {\n  const m3u8 = await onCall({ _: 'onNetwork', url, matchs: ['.m3u8'] })\n  return m3u8.split('=').at(-1)\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/twitter/1899328471513624576/ff93ae8732750cbab24e66370c4e871f_regular.webp",
    "link": [
      "https://missav.live/",
      "https://missav.ai/",
      "https://missav.ws/"
    ],
    "name": "MISSAV",
    "meta": [
      "JAV"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/twitter/1899328471513624576/ff93ae8732750cbab24e66370c4e871f_regular.webp',\n  link: ['https://missav.live/', 'https://missav.ai/', 'https://missav.ws/'],\n  name: 'MISSAV',\n  meta: ['JAV']\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  list: {\n    url: 'cn/{{path}}',\n    path: ['path'],\n    query: ['page'],\n    defaults: { path: 'new' }\n  },\n  search: {\n    url: 'cn/search/{{query}}',\n    path: ['query'],\n    query: ['page'],\n  },\n  actresses: {\n    url: 'cn/actresses/{{actresses}}',\n    path: ['actresses'],\n    query: ['page'],\n  },\n  genres: {\n    url: 'cn/genres/{{genres}}',\n    path: ['genres'],\n    query: ['page'],\n  },\n  series: {\n    url: 'cn/series/{{series}}',\n    path: ['series'],\n    query: ['page'],\n  },\n  makers: {\n    url: 'cn/makers/{{makers}}',\n    path: ['makers'],\n    query: ['page'],\n  },\n  tags: {\n    url: 'cn/tags/{{tags}}',\n    path: ['tags'],\n    query: ['page'],\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => {\n  const genres = []\n\n  // Gemini: 获取所有类型页面\n  for (const p of [1, 2, 3]) {\n    const document = await fetchHTML(`${info.link[0]}cn/genres?page=${p}`)\n    const links = [...document.querySelectorAll('a.text-nord13')]\n      .map(v => v.getAttribute('href'))\n      .filter(f => f?.includes('genres'))\n\n    for (const href of links) {\n      const name = decodeURIComponent(href.split('/').slice(-1)[0])\n      genres.push({ mode: 'radio', name, code: `genres=${name}` })\n    }\n  }\n\n  return [\n    { mode: 'radio', name: '最新', code: 'path=new' },\n    { mode: 'radio', name: '中文字幕', code: 'path=chinese-subtitle' },\n    { mode: 'radio', name: '新作上市', code: 'path=release' },\n    { mode: 'radio', name: '无码流出', code: 'path=uncensored-leak' },\n    { mode: 'line', name: '排行' },\n    { mode: 'radio', name: '今日热门', code: 'path=today-hot' },\n    { mode: 'radio', name: '本週热门', code: 'path=weekly-hot' },\n    { mode: 'radio', name: '本月热门', code: 'path=monthly-hot' },\n    { mode: 'line', name: '类型' },\n    ...genres\n  ]\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n\n  // Gemini: 路由选择优先级\n  const routeKeys = ['actresses', 'genres', 'series', 'makers', 'tags']\n  const activeKey = routeKeys.find(k => params[k])\n  if (activeKey) {\n    config.route = activeKey\n  } else if (params.tag || params.query) {\n    config.route = 'search'\n    params.query = params.tag || params.query\n  } else if (params.path) {\n    config.route = 'list'\n  } else if (!config.route) {\n    config.route = 'list'\n  }\n\n  const { url } = build(info.link[0], routes, config, params)\n  const document = await fetchHTML(encodeURI(decodeURI(url)))\n\n  return [...document.querySelectorAll('.thumbnail.group')].map(el => ({\n    mode: 'video',\n    link: el.querySelector('a')?.getAttribute('href'),\n    cove: [el.querySelector('img')?.getAttribute('data-src')],\n    name: [el.querySelector('.truncate')?.textContent?.trim()],\n    card: `function:card(\"${el.querySelector('a')?.getAttribute('href')}\")`\n  }))\n}\n\n// ==================== 详情解析 ====================\nconst card = async (url = '') => {\n  const matchs = ['playlist.m3u8', 'video.m3u8', 'surrit.com']\n  const document = await fetchHTML(url)\n  const words = []\n\n  const containers = [...document.querySelectorAll('div.text-secondary')]\n  for (const container of containers) {\n    const label = container.querySelector('span')?.textContent?.replace(':', '')?.trim()\n    if (!label || label === '标题') continue\n\n    const keyMap = {\n      '女优': 'actresses',\n      '类型': 'genres',\n      '系列': 'series',\n      '发行商': 'makers',\n      '标籤': 'tags'\n    }\n    const links = [...container.querySelectorAll('a')]\n    if (links.length > 0) {\n      const key = keyMap[label] || 'tag'\n      links.forEach(link => {\n        const name = link.textContent.trim()\n        if (name) words.push(`${name}@${key}=${name}`)\n      })\n    }\n  }\n\n  const video = await onCall({ _: 'onNetwork', url, matchs })\n  return {\n    word: words,\n    card: [{ video }]\n  }\n}"
  },
  {
    "cove": "https://cdn.manyacg.top/pixiv/64774919/af98027387f519037717c3c73fab48ba_regular.webp",
    "name": "绅士漫画",
    "link": [
      "https://www.wn07.ru/",
      "https://wn06.ru/",
      "https://www.wnacg05.cc/",
      "https://www.wn05.ru/",
      "https://www.wn04.ru/",
      "https://www.wnacg.com/",
      "https://www.wnacg.ru/"
    ],
    "meta": [
      "本子"
    ],
    "code": "// ==================== 模块信息 ====================\nconst info = {\n  cove: 'https://cdn.manyacg.top/pixiv/64774919/af98027387f519037717c3c73fab48ba_regular.webp',\n  name: '绅士漫画',\n  link: ['https://www.wn07.ru/', 'https://wn06.ru/', 'https://www.wnacg05.cc/', 'https://www.wn05.ru/', 'https://www.wn04.ru/', 'https://www.wnacg.com/', 'https://www.wnacg.ru/'],\n  meta: ['本子'],\n}\n\n// ==================== 路由配置 ====================\nconst routes = {\n  list: {\n    url: '{{albums}}{{cate}}{{tag}}{{type}}{{page}}.html',\n    path: [\n      { key: 'albums', prefix: 'albums-', suffix: '-' },\n      { key: 'cate', prefix: 'cate-', suffix: '-' },\n      { key: 'tag', prefix: 'tag-', suffix: '-' },\n      { key: 'type', prefix: 'type-', suffix: '-' },\n      { key: 'page', prefix: 'page-' }\n    ],\n    defaults: { albums: 'index', page: 1 }\n  },\n  search: {\n    url: 'search/index.php',\n    query: ['q', 'p', 'm', 'syn', 'f', 's'],\n    defaults: { m: '', syn: 'yes', f: '_all', s: 'create_time_DESC', p: 1 }\n  }\n}\n\n// ==================== 过滤器 ====================\nconst meta = async () => {\n  const document = await fetchHTML(info.link[0])\n  const items = []\n\n  items.push({ mode: 'radio', name: '最近更新', code: 'albums=index' })\n  items.push({ mode: 'radio', name: '今日排行', code: 'albums=favorite_ranking type=day' })\n  items.push({ mode: 'radio', name: '本周排行', code: 'albums=favorite_ranking type=week' })\n  items.push({ mode: 'radio', name: '本月排行', code: 'albums=favorite_ranking type=month' })\n\n  const navItems = [...document.querySelectorAll('#album_tabs > li')]\n  for (const li of navItems) {\n    const mainA = li.querySelector('a')\n    const name = mainA?.innerText.trim()\n    const href = mainA?.getAttribute('href') || ''\n\n    if (!name || name === '首頁' || name === '論壇' || name === '更新' || name === '排行' || href.includes('wnbbs')) continue\n\n    items.push({ mode: 'line', name: name })\n\n    const mainCate = href.match(/cate-(\\d+)/)?.[1]\n    if (mainCate) {\n      items.push({ mode: 'radio', name: `全部${name}`, code: `cate=${mainCate}` })\n    }\n\n    const subs = li.querySelectorAll('.onemenulayout a')\n    for (const sub of subs) {\n      const subName = sub.innerText.trim()\n      const subHref = sub.getAttribute('href') || ''\n      const subCate = subHref.match(/cate-(\\d+)/)?.[1]\n      if (subCate) {\n        items.push({ mode: 'radio', name: `${name}-${subName}`, code: `cate=${subCate}` })\n      }\n    }\n  }\n\n  return items\n}\n\n// ==================== 列表请求 ====================\nconst post = async (...args) => {\n  const input = args.join(' ') || 'page=1'\n  const { config, params } = parse(input)\n  params.q = params.query\n  params.p = params.page\n  const { url } = build(info.link[0], routes, config, params)\n  const document = await fetchHTML(url)\n  return [...document.querySelectorAll('.pic_box a')]\n    .filter(el => el.getAttribute('href')?.includes('/photos'))\n    .map(el => {\n      const href = el.getAttribute('href')\n      const fullLink = URL.parse(href, url).href\n      const imgSrc = el.querySelector('img')?.getAttribute('src')\n      const fullCove = URL.parse(imgSrc, url).href\n      return {\n        mode: 'comic',\n        link: fullLink,\n        cove: [fullCove],\n        name: [el.getAttribute('title')],\n        card: `function:card(\"${fullLink}\")`\n      }\n    })\n}\n\n// ==================== 详情解析 ====================\nconst card = async (link = '') => {\n  const document = await fetchHTML(link)\n  const metaInfo = [...document.querySelectorAll('.uwconn > label')]\n    .map(el => el.innerText.replace(/[：:]/g, '').replace('分類', '').replace('頁數', '').trim())\n    .filter(Boolean)\n\n  // Gemini: 提取标签，返回 名称@tag=名称 以支持点击跳转\n  const tags = [...document.querySelectorAll('.addtags a.tagshow')].map(el => {\n    const tagName = el.innerText.trim()\n    return `${tagName}@tag=${tagName}`\n  })\n\n  // Gemini: 获取图片列表\n  const gallery = await fetch(link.replace('photos-index', 'photos-gallery'))\n    .then(v => v.text())\n    .then(text => {\n      const regex = RegExp(String.raw`//[^\\\"]+/[^\\\"]+\\.[^\\\"]+`, 'g');\n      const matches = Array.from(text.matchAll(regex));\n      return matches.map((e) => 'https:' + e[0].substring(0, e[0].length - 1))\n    })\n\n  return {\n    word: [...metaInfo, ...tags],\n    card: [{ image: gallery }]\n  }\n}\n"
  }
]